---
import Layout from '../../layouts/Layout.astro';
import { projects } from '../../data/projects';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = () => {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
};

const { project } = Astro.props;

const currentIndex = projects.findIndex((p) => p.slug === project.slug);
const prevProject = projects[(currentIndex - 1 + projects.length) % projects.length];
const nextProject = projects[(currentIndex + 1) % projects.length];

const stageLabels: Record<string, string> = {
  seeding: 'Seeding',
  sprouting: 'Sprouting',
  growing: 'Growing',
  grown: 'In Full Bloom',
  harvested: 'Grown',
};

const stageEmoji: Record<string, string> = {
  seeding: '\u{1F331}',
  sprouting: '\u{1F33F}',
  growing: '\u{1F33A}',
  grown: '\u{1F338}',
  harvested: '\u{1F33E}',
};

const stageColors: Record<string, string> = {
  seeding: '#c4b090',
  sprouting: '#8fa87c',
  growing: '#c4727a',
  grown: '#b8636c',
  harvested: '#8a7a5a',
};
---

<Layout title={`${project.name} | BuiltByProxy`}>
  <main class="detail-page" style="background: linear-gradient(to bottom, var(--sky-color-top), var(--sky-color-bottom));">
    <!-- Night overlay -->
    <div class="night-overlay" id="nightOverlay"></div>
    <div id="starsContainer" class="fixed inset-0 pointer-events-none z-[14]"></div>
    <div id="firefliesContainer" class="fixed inset-0 pointer-events-none z-[16]"></div>

    <!-- Landscape background -->
    <div class="detail-bg">
      <!-- Drifting clouds (generated by JS) -->
      <div class="cloud-track"></div>

      <!-- Distant hills -->
      <svg class="absolute bottom-0 left-0 w-full" style="height: 55%;" viewBox="0 0 1200 400" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <filter id="dwc"><feTurbulence type="fractalNoise" baseFrequency="0.04" numOctaves="5" result="n"/><feDisplacementMap in="SourceGraphic" in2="n" scale="6"/></filter>
          <filter id="dwcs"><feTurbulence type="fractalNoise" baseFrequency="0.03" numOctaves="4" result="n"/><feDisplacementMap in="SourceGraphic" in2="n" scale="4"/></filter>
        </defs>
        <g filter="url(#dwcs)" opacity="0.25">
          <path d="M 0 280 Q 100 220 200 250 Q 350 200 500 240 Q 650 190 800 230 Q 950 200 1100 220 L 1200 260 L 1200 400 L 0 400 Z" fill="var(--hill-far-color)"/>
        </g>
        <g filter="url(#dwc)" opacity="0.3">
          <path d="M 0 300 Q 150 260 300 285 Q 450 250 600 275 Q 750 245 900 270 Q 1050 250 1200 280 L 1200 400 L 0 400 Z" fill="var(--hill-mid-color)"/>
        </g>
      </svg>

      <!-- Grass layer -->
      <svg class="absolute bottom-0 left-0 w-full" style="height: 55%;" viewBox="0 0 1200 400" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <filter id="dwc2"><feTurbulence type="fractalNoise" baseFrequency="0.04" numOctaves="5" result="n"/><feDisplacementMap in="SourceGraphic" in2="n" scale="6"/></filter>
          <filter id="dink"><feTurbulence type="fractalNoise" baseFrequency="0.05" numOctaves="3" result="n"/><feDisplacementMap in="SourceGraphic" in2="n" scale="2"/></filter>
        </defs>
        <g filter="url(#dwc2)">
          <path d="M 0 320 Q 200 300 400 315 Q 600 298 800 312 Q 1000 300 1200 318 L 1200 400 L 0 400 Z" fill="#a3b893" opacity="0.6"/>
          <path d="M 0 330 Q 150 318 350 328 Q 550 312 750 325 Q 950 315 1200 330 L 1200 400 L 0 400 Z" fill="#8fa87c" opacity="0.7"/>
          <path d="M 0 345 Q 200 335 400 342 Q 600 332 800 340 Q 1000 334 1200 345 L 1200 400 L 0 400 Z" fill="var(--grass-color)" opacity="0.8"/>
        </g>
        <g filter="url(#dink)">
          <path d="M 0 342 Q 100 336 200 340 Q 300 334 400 339 Q 500 333 600 338 Q 700 332 800 337 Q 900 333 1000 338 Q 1100 334 1200 340" stroke="#4a5a3e" stroke-width="1.5" fill="none" opacity="0.4"/>
        </g>
      </svg>
    </div>

    <!-- Top nav -->
    <nav class="project-nav">
      <a href="/" class="nav-bio">
        <span class="nav-name">Lachlan Young</span>
        <span class="nav-handle">@builtbyproxy</span>
      </a>
      <div class="nav-right">
        <div class="nav-socials">
          <a href="https://github.com/builtbyproxy" target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="nav-social">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          </a>
          <a href="https://linkedin.com/in/builtbyproxy" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="nav-social">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
          </a>
          <a href="https://x.com/builtbyproxy" target="_blank" rel="noopener noreferrer" aria-label="X / Twitter" class="nav-social">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          </a>
        </div>
        <a href="/" class="back-link">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
          Back to garden
        </a>
        <button class="theme-toggle" aria-label="Toggle day/night mode">
          <svg class="theme-icon theme-icon-sun" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
          <svg class="theme-icon theme-icon-moon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
        </button>
      </div>
    </nav>

    <div class="detail-content">
      <div class="detail-card">
        <div class="detail-columns">
          <!-- Left: project info -->
          <div class="detail-info">
            <!-- Centered header: favicon, title, stage -->
            <div class="detail-header">
              <div class="detail-favicon">
                {project.icon ? (
                  <span class="favicon-fallback">{project.icon}</span>
                ) : project.url ? (
                  <img
                    src={`https://www.google.com/s2/favicons?domain=${new URL(project.url).hostname}&sz=128`}
                    alt={`${project.name} favicon`}
                    width="64"
                    height="64"
                    onerror="this.style.display='none';this.nextElementSibling.style.display='block';"
                  />
                  <span class="favicon-fallback" style="display:none;">&#127804;</span>
                ) : (
                  <span class="favicon-fallback">&#127802;</span>
                )}
              </div>

              <h1 class="detail-title">{project.name}</h1>

              <div class="detail-stage" style={`border-color: ${stageColors[project.stage]}`}>
                <span>{stageEmoji[project.stage]}</span>
                <span>{stageLabels[project.stage]}</span>
              </div>
            </div>

            <!-- Left-aligned body -->
            <p class="detail-description">{project.description}</p>

            <div class="detail-divider">
              <svg viewBox="0 0 200 8" xmlns="http://www.w3.org/2000/svg" class="w-32">
                <path d="M 0 4 Q 25 0 50 4 Q 75 8 100 4 Q 125 0 150 4 Q 175 8 200 4" stroke="#c4b090" stroke-width="1" fill="none" opacity="0.5"/>
              </svg>
            </div>

            <p class="detail-details">{project.details}</p>

            {project.url && (
              <a href={project.url} target="_blank" rel="noopener noreferrer" class="detail-link">
                Visit Project
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
              </a>
            )}
          </div>

          <!-- Right: browser screenshot -->
          {project.url && (
            <div class="detail-preview">
              <div class="browser-frame">
                <div class="browser-bar">
                  <div class="browser-dots">
                    <span class="dot dot-red"></span>
                    <span class="dot dot-yellow"></span>
                    <span class="dot dot-green"></span>
                  </div>
                  <div class="browser-url">
                    <span>{project.url.replace(/^https?:\/\//, '')}</span>
                  </div>
                </div>
                <div class="browser-viewport">
                  <iframe
                    src={project.slug === 'rubyhash' ? `${project.url}?theme=dark` : project.url}
                    title={`${project.name} preview`}
                    loading="lazy"
                    sandbox="allow-scripts allow-same-origin"
                  ></iframe>
                </div>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>

    <!-- Prev / Next navigation -->
    <a href={`/projects/${prevProject.slug}`} class="carousel-nav carousel-prev" aria-label={`Previous: ${prevProject.name}`}>
      <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
      <span class="carousel-label">{prevProject.name}</span>
    </a>
    <a href={`/projects/${nextProject.slug}`} class="carousel-nav carousel-next" aria-label={`Next: ${nextProject.name}`}>
      <span class="carousel-label">{nextProject.name}</span>
      <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"/></svg>
    </a>
  </main>
</Layout>

<style>
  .detail-page {
    position: relative;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 3.5rem 1rem 1.5rem;
  }

  @media (min-width: 640px) {
    .detail-page {
      padding: 5rem 2rem 2rem;
    }
  }

  .detail-bg {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  /* Top nav bar */
  .project-nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 30;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem 0.75rem;
    background: var(--surface-bg);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--surface-border);
  }

  @media (min-width: 640px) {
    .project-nav {
      padding: 0.65rem 1.5rem;
    }
  }

  .nav-bio {
    display: flex;
    align-items: baseline;
    gap: 0.35rem;
    text-decoration: none;
    transition: opacity 0.2s ease;
    min-width: 0;
  }

  @media (min-width: 640px) {
    .nav-bio {
      gap: 0.5rem;
    }
  }

  .nav-bio:hover {
    opacity: 0.7;
  }

  .nav-name {
    font-family: 'DM Serif Display', serif;
    font-size: 0.95rem;
    color: var(--text-color);
  }

  @media (min-width: 640px) {
    .nav-name {
      font-size: 1.15rem;
    }
  }

  .nav-handle {
    font-family: 'Caveat', cursive;
    font-size: 0.85rem;
    color: var(--text-muted);
    display: none;
  }

  @media (min-width: 480px) {
    .nav-handle {
      display: inline;
    }
  }

  @media (min-width: 640px) {
    .nav-handle {
      font-size: 0.95rem;
    }
  }

  .nav-right {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  @media (min-width: 640px) {
    .nav-right {
      gap: 1.25rem;
    }
  }

  .nav-socials {
    display: none;
    align-items: center;
    gap: 0.6rem;
  }

  @media (min-width: 640px) {
    .nav-socials {
      display: flex;
    }
  }

  .nav-social {
    color: var(--text-accent);
    display: flex;
    align-items: center;
    transition: color 0.2s ease, transform 0.2s ease;
  }

  .nav-social:hover {
    color: var(--text-color);
    transform: translateY(-1px);
  }

  .detail-content {
    position: relative;
    z-index: 10;
    max-width: 960px;
    width: 100%;
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    font-family: 'Caveat', cursive;
    font-size: 1rem;
    color: var(--text-accent);
    text-decoration: none;
    padding: 0.25rem 0.65rem 0.25rem 0.45rem;
    border: 1px solid var(--surface-border);
    border-radius: 999px;
    transition: color 0.2s ease, background 0.2s ease;
  }

  .back-link:hover {
    color: var(--text-color);
    background: rgba(106, 122, 94, 0.08);
  }

  .detail-card {
    background: var(--surface-bg-solid);
    backdrop-filter: blur(8px);
    border: 1px solid var(--surface-border);
    padding: 1.5rem 1.25rem;
    clip-path: polygon(
      0% 1.5%, 2% 0%, 5% 1.5%, 8% 0.5%, 12% 1.5%, 16% 0%, 20% 1%, 24% 0.5%, 28% 1.5%,
      32% 0%, 36% 1%, 40% 0.5%, 44% 1.5%, 48% 0%, 52% 1%, 56% 0.5%, 60% 1.5%,
      64% 0%, 68% 1%, 72% 0.5%, 76% 1.5%, 80% 0%, 84% 1%, 88% 0.5%, 92% 1.5%,
      96% 0%, 100% 1%,
      100% 98.5%, 96% 100%, 92% 98.5%, 88% 99.5%, 84% 99%, 80% 100%, 76% 98.5%,
      72% 99.5%, 68% 99%, 64% 100%, 60% 98.5%, 56% 99.5%, 52% 99%, 48% 100%,
      44% 98.5%, 40% 99.5%, 36% 99%, 32% 100%, 28% 98.5%, 24% 99.5%, 20% 99%,
      16% 100%, 12% 98.5%, 8% 99.5%, 5% 98.5%, 2% 100%, 0% 98.5%
    );
  }

  .detail-columns {
    display: flex;
    gap: 2.5rem;
    align-items: stretch;
  }

  .detail-info {
    flex: 1;
    min-width: 0;
    text-align: left;
  }

  .detail-preview {
    flex: 1;
    min-width: 0;
    display: none;
  }

  @media (min-width: 640px) {
    .detail-card {
      padding: 2.5rem 2rem;
    }
  }

  @media (min-width: 768px) {
    .detail-preview {
      display: flex;
      flex-direction: column;
    }
  }

  .detail-header {
    text-align: center;
    margin-bottom: 1.25rem;
  }

  .detail-favicon {
    display: flex;
    justify-content: center;
    margin-bottom: 1rem;
  }

  .detail-favicon img {
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  }

  .favicon-fallback {
    font-size: 2.5rem;
    line-height: 1;
  }

  @media (min-width: 640px) {
    .favicon-fallback {
      font-size: 3.5rem;
    }
  }

  .detail-title {
    font-family: 'DM Serif Display', serif;
    font-size: 1.5rem;
    color: var(--text-color);
    margin: 0 0 0.75rem;
  }

  @media (min-width: 640px) {
    .detail-title {
      font-size: 2rem;
    }
  }

  .detail-stage {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    font-family: 'Caveat', cursive;
    font-size: 1rem;
    color: var(--text-color);
    border: 1px solid;
    padding: 0.2rem 0.75rem;
    border-radius: 999px;
    margin-bottom: 1.25rem;
  }

  .detail-description {
    font-family: 'Inter', sans-serif;
    font-size: 0.95rem;
    color: var(--text-color);
    line-height: 1.6;
    margin: 0 0 1rem;
  }

  .detail-divider {
    display: flex;
    justify-content: center;
    margin: 1rem 0;
  }

  .detail-details {
    font-family: 'Caveat', cursive;
    font-size: 1.1rem;
    color: var(--text-muted);
    line-height: 1.5;
    margin: 0 0 1.5rem;
  }

  .detail-link {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    font-family: 'Inter', sans-serif;
    font-size: 0.85rem;
    color: #faf7f0;
    background: #6a7a5e;
    padding: 0.5rem 1.25rem;
    border-radius: 6px;
    text-decoration: none;
    transition: background 0.2s ease, transform 0.2s ease;
  }

  .detail-link:hover {
    background: #4a5a3e;
    transform: translateY(-1px);
  }

  /* Browser frame mockup */
  .browser-frame {
    border: 1px solid var(--surface-border);
    border-radius: 8px;
    overflow: hidden;
    background: #fff;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .browser-bar {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.5rem 0.75rem;
    background: var(--surface-bg-solid);
    border-bottom: 1px solid var(--surface-border);
  }

  .browser-dots {
    display: flex;
    gap: 5px;
    flex-shrink: 0;
  }

  .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }

  .dot-red { background: #ec6a5e; }
  .dot-yellow { background: #f4bf4f; }
  .dot-green { background: #61c554; }

  .browser-url {
    flex: 1;
    background: rgba(255, 255, 255, 0.6);
    border-radius: 4px;
    padding: 0.2rem 0.6rem;
    font-family: 'Inter', sans-serif;
    font-size: 0.7rem;
    color: var(--text-muted);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .browser-viewport {
    flex: 1;
    position: relative;
    overflow: hidden;
  }

  .browser-viewport iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 200%;
    height: 200%;
    transform: scale(0.5);
    transform-origin: top left;
    border: none;
    pointer-events: none;
  }

  /* Carousel prev/next nav */
  .carousel-nav {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    z-index: 20;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 0.65rem;
    min-height: 44px;
    min-width: 44px;
    justify-content: center;
    background: var(--surface-bg);
    backdrop-filter: blur(6px);
    border: 1px solid var(--surface-border);
    border-radius: 999px;
    color: var(--text-color);
    opacity: 0.7;
    text-decoration: none;
    transition: opacity 0.25s ease, transform 0.25s ease, background 0.25s ease;
  }

  @media (min-width: 640px) {
    .carousel-nav {
      padding: 0.75rem 1rem;
    }
  }

  .carousel-nav:hover {
    opacity: 1;
    background: var(--surface-bg-solid);
  }

  .carousel-prev {
    left: 0;
    border-radius: 0 999px 999px 0;
    border-left: none;
  }

  .carousel-prev:hover {
    transform: translateY(-50%) translateX(-4px);
  }

  .carousel-next {
    right: 0;
    border-radius: 999px 0 0 999px;
    border-right: none;
  }

  .carousel-next:hover {
    transform: translateY(-50%) translateX(4px);
  }

  .carousel-label {
    font-family: 'Caveat', cursive;
    font-size: 1.1rem;
    font-weight: 600;
    white-space: nowrap;
    display: none;
  }

  @media (min-width: 1100px) {
    .carousel-label {
      display: inline;
    }
  }
</style>

<script>
  // Night elements (always created; CSS controls visibility)
  const starsContainer = document.getElementById('starsContainer');
  const firefliesContainer = document.getElementById('firefliesContainer');

  if (starsContainer) {
    for (let i = 0; i < 60; i++) {
      const star = document.createElement('div');
      star.className = 'star';
      star.style.left = `${Math.random() * 100}%`;
      star.style.top = `${Math.random() * 50}%`;
      star.style.animationDelay = `${Math.random() * 5}s`;
      star.style.animationDuration = `${2 + Math.random() * 4}s`;
      starsContainer.appendChild(star);
    }
  }
  if (firefliesContainer) {
    for (let i = 0; i < 12; i++) {
      const firefly = document.createElement('div');
      firefly.className = 'firefly';
      firefly.style.left = `${10 + Math.random() * 80}%`;
      firefly.style.top = `${40 + Math.random() * 50}%`;
      firefly.style.animationDelay = `${Math.random() * 6}s`;
      firefly.style.animationDuration = `${4 + Math.random() * 5}s`;
      firefliesContainer.appendChild(firefly);
    }
  }

  // Keyboard navigation: left/right arrows for prev/next project
  const prevLink = document.querySelector('.carousel-prev') as HTMLAnchorElement;
  const nextLink = document.querySelector('.carousel-next') as HTMLAnchorElement;

  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft' && prevLink) {
      prevLink.click();
    } else if (e.key === 'ArrowRight' && nextLink) {
      nextLink.click();
    }
  });

  // Plausible custom events
  const plausible = (window as any).plausible;
  const projectName = document.querySelector('.detail-title')?.textContent?.trim();

  document.querySelector('.detail-link')?.addEventListener('click', () => {
    if (projectName) plausible?.('Visit Project', { props: { project: projectName } });
  });

  document.querySelectorAll('.carousel-nav').forEach((nav) => {
    nav.addEventListener('click', () => {
      const label = nav.querySelector('.carousel-label')?.textContent?.trim();
      plausible?.('Carousel Navigate', { props: { to: label || 'unknown' } });
    });
  });

  document.querySelectorAll('.nav-social').forEach((link) => {
    link.addEventListener('click', () => {
      const label = (link as HTMLAnchorElement).getAttribute('aria-label') || 'unknown';
      plausible?.('Social Click', { props: { platform: label } });
    });
  });
</script>
